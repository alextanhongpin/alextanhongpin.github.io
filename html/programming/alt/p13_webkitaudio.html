<!DOCTYPE html>
<html lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../css/grid_layout.css">
    <script src='http://code.jquery.com/jquery-2.1.1.js'></script>
<style>
   

    
    *{
        margin: 0;
        padding: 0;
    }
    
    body{
        -moz-user-select: none; 
        -webkit-user-select: none; 
        -ms-user-select:none;
        cursor: pointer;
        user-select:none;
        background: #fff;
        width: 100%;
        height: 100%;
        display: block;
        text-align: center;
        font-family: Tahoma;
    }
    
    #canvas{
        display: block;
    }
    
  
</style>
      
    <title>@alextanhongpin</title>
      
  </head>
  <body>
      
       <p>Web audio API example: load a sound file and play/stop it on a button click.</p>
  <button onclick="initContext()">Init</button>
  <button onclick="loadSound(url)">Load</button>
  <button onclick="playSound(myAudioBuffer)">Play</button>
  <button onclick="stopSound()">Stop</button>
      
      <canvas id='canvas'></canvas>
   </body>
    
  <script>//$(document).ready(function(){

   // 'use strict';
    
    var canvas = document.getElementById('canvas');
        canvas.height = window.innerHeight;
        canvas.width = window.innerWidth;
    var drawContext = canvas.getContext('2d');
var context;
function initContext() {
  try {
    context = new webkitAudioContext();
    alert("context created"); //test
  }
  catch(e) {
    alert('Sorry, your browser does not support the Web Audio API.');
  }
}
 
//Step 2
var myAudioBuffer = null;
 
//Steps 3 and 4
var url = '/audio/GMS%20Juice%20-%20Requiem%20of%20a%20Dream.mp3';
      
function loadSound(url) {
  var request = new XMLHttpRequest();
  request.open('GET', url, true);
  request.responseType = 'arraybuffer';
  // . . . step 3 code above this line, step 4 code below
  request.onload = function() {

    context.decodeAudioData(request.response, function(buffer) {
      myAudioBuffer = buffer;
    });
      
  }
  request.send();
}
 
//Step 5
var source = null;

function playSound(anybuffer) {
  source = context.createBufferSource();
    analyser = context.createAnalyser();
    
  source.buffer = anybuffer;
  source.connect(context.destination);

    
  source.start();
  //source.noteOn(0); //see note in Step 6 text
}
 
      
    
          
      }
//Step 6
function stopSound() {
  if (source) {
    source.stop();
    //source.noteOff(0); //see note in Step 6 text
  }
}
    
    
    //setInterval(loop, FRAME_RATE);
    
//});</script>
</html>